<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Writer - AssignSavvy</title>
  <link rel="icon" type="image/svg+xml" href="./assets/favicon.svg">
  <link rel="stylesheet" href="./styles/main.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
  <div class="dashboard-layout">
    <!-- Top Bar -->
    <div class="dashboard-topbar">
      <div class="topbar-left">
        <button class="sidebar-toggle" id="sidebar-toggle">
          <i class="fas fa-bars"></i>
        </button>
        <div class="topbar-logo">
          ðŸ“š AssignSavvy
        </div>
      </div>
      <div class="topbar-title">AI Writer</div>
      <div class="topbar-actions">
        <button class="notification-btn" id="notification-btn">
          <i class="fas fa-bell"></i>
          <div class="notification-badge"></div>
        </button>
        <a href="index.html" class="home-btn">
          <i class="fas fa-home"></i>
          <span>Home</span>
        </a>
      </div>
    </div>
    
    <!-- Sidebar -->
    <div class="dashboard-sidebar" id="dashboard-sidebar">
      <!-- Navigation -->
      <ul class="sidebar-nav">
        <li>
          <a href="dashboard.html" class="sidebar-nav-item">
            <i class="fas fa-chart-line"></i>
            <span>Dashboard</span>
          </a>
        </li>
        <li>
          <a href="writer.html" class="sidebar-nav-item active">
            <i class="fas fa-pen"></i>
            <span>Writer</span>
          </a>
        </li>
        <li>
          <a href="researcher.html" class="sidebar-nav-item">
            <i class="fas fa-magnifying-glass"></i>
            <span>Researcher</span>
          </a>
        </li>
        <li>
          <a href="detector.html" class="sidebar-nav-item">
            <i class="fas fa-shield-halved"></i>
            <span>Originality Detector</span>
          </a>
        </li>
        <li>
          <a href="prompt-engineer.html" class="sidebar-nav-item">
            <i class="fas fa-code"></i>
            <span>Prompt Engineer</span>
          </a>
        </li>
        <li>
          <a href="history.html" class="sidebar-nav-item">
            <i class="fas fa-clock-rotate-left"></i>
            <span>History</span>
          </a>
        </li>
      </ul>
      
      <!-- User Account Info -->
      <div class="user-account-info">
        <div class="user-profile-card" id="user-profile-card" style="cursor: pointer;">
          <div class="user-avatar">
            <i class="fas fa-user-circle"></i>
          </div>
          <div class="user-details">
            <h4 id="user-name">User Name</h4>
            <p class="user-plan" id="user-plan">Free Plan</p>
            <div class="user-credits">
              <i class="fas fa-coins"></i>
              <span id="user-credits">145/200 Credits</span>
            </div>
          </div>
        </div>
      </div>
    </div>
    
    <!-- Main Content -->
    <div class="dashboard-content">
      <!-- Header -->
      <div class="section-header">
        <h2>AI Writer</h2>
        <div class="header-actions">
          <button class="btn btn-outline" id="upload-files-btn">
            <i class="fas fa-upload"></i> Upload Files
          </button>
          <button class="btn btn-outline" id="open-history-btn">
            <i class="fas fa-history"></i> History
          </button>
        </div>
      </div>
      
      <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
        <!-- Input Section -->
        <div class="lg:col-span-2">
          <div class="card">
            <h3 class="mb-4">Content Generation</h3>
            
            <!-- Content Type Selection -->
            <div class="form-group mb-4">
              <label>Content Type</label>
              <div class="flex gap-2 mb-2">
                <button class="btn btn-outline btn-sm active" data-type="general">General Content</button>
                <button class="btn btn-outline btn-sm" data-type="assignment">Assignment</button>
              </div>
            </div>
            
            <!-- Assignment Title (hidden by default) -->
            <div class="form-group mb-4" id="assignment-title-group" style="display: none;">
              <label for="assignment-title">Assignment Title</label>
              <input type="text" id="assignment-title" class="form-input" placeholder="Enter assignment title...">
            </div>
            
            <!-- Main Prompt -->
            <div class="form-group mb-4">
              <label for="content-prompt">Content Prompt</label>
              <textarea id="content-prompt" class="form-input" rows="8" placeholder="Describe what you want to write about..."></textarea>
              <div class="text-right text-sm text-gray mt-1">0 words</div>
            </div>
            
            <!-- Style and Tone -->
            <div class="grid grid-cols-2 gap-4 mb-4">
              <div class="form-group">
                <label for="writing-style">Writing Style</label>
                <select id="writing-style" class="form-input">
                  <option value="Academic">Academic</option>
                  <option value="Business">Business</option>
                  <option value="Creative">Creative</option>
                  <option value="Casual">Casual</option>
                </select>
              </div>
              <div class="form-group">
                <label for="writing-tone">Writing Tone</label>
                <select id="writing-tone" class="form-input">
                  <option value="Formal">Formal</option>
                  <option value="Casual">Casual</option>
                  <option value="Persuasive">Persuasive</option>
                  <option value="Informative">Informative</option>
                </select>
              </div>
            </div>
            
            <!-- Word Count and Quality -->
            <div class="grid grid-cols-2 gap-4 mb-4">
              <div class="form-group">
                <label for="word-count">Target Word Count</label>
                <input type="number" id="word-count" class="form-input" value="500" min="100" max="2000">
              </div>
              <div class="form-group">
                <label for="quality-tier">Quality Tier</label>
                <select id="quality-tier" class="form-input">
                  <option value="standard">Standard (1x credits)</option>
                  <option value="premium">Premium (2x credits)</option>
                </select>
              </div>
            </div>
            
            <!-- Citation Options (for assignments) -->
            <div id="citation-options" style="display: none;">
              <div class="grid grid-cols-2 gap-4 mb-4">
                <div class="form-group">
                  <label for="citation-style">Citation Style</label>
                  <select id="citation-style" class="form-input">
                    <option value="APA">APA</option>
                    <option value="MLA">MLA</option>
                    <option value="Chicago">Chicago</option>
                    <option value="Harvard">Harvard</option>
                  </select>
                </div>
                <div class="form-group">
                  <label class="checkbox-container">
                    <input type="checkbox" id="require-citations" checked>
                    <span class="checkmark"></span>
                    Include Citations
                  </label>
                </div>
              </div>
            </div>
            
            <!-- Additional Instructions -->
            <div class="form-group mb-6">
              <label for="additional-instructions">Additional Instructions (Optional)</label>
              <textarea id="additional-instructions" class="form-input" rows="3" placeholder="Any specific requirements or instructions..."></textarea>
            </div>
            
            <button class="btn btn-primary w-full" id="generate-btn">
              <i class="fas fa-magic"></i> Generate Content
            </button>
          </div>
        </div>
        
        <!-- Output Section -->
        <div>
          <div class="card">
            <div class="flex justify-between items-center mb-4">
              <h3>Generated Content</h3>
              <div class="flex gap-2" id="output-actions" style="display: none;">
                <button class="btn btn-icon" id="copy-btn" title="Copy to clipboard">
                  <i class="fas fa-copy"></i>
                </button>
                <button class="btn btn-icon" id="download-btn" title="Download">
                  <i class="fas fa-download"></i>
                </button>
                <button class="btn btn-icon" id="save-btn" title="Save to history">
                  <i class="fas fa-save"></i>
                </button>
              </div>
            </div>
            
            <!-- Initial State -->
            <div id="no-content" class="text-center py-12">
              <i class="fas fa-pen-fancy text-4xl text-gray mb-4"></i>
              <h4>Ready to Write</h4>
              <p class="text-gray">Enter your prompt to generate content</p>
            </div>
            
            <!-- Loading State -->
            <div id="loading-content" style="display: none;" class="text-center py-12">
              <div class="spinner mb-4"></div>
              <h4>Generating Content...</h4>
              <p class="text-gray" id="loading-message">Processing your request</p>
            </div>
            
            <!-- Output State -->
            <div id="content-output" style="display: none;">
              <textarea id="generated-content" class="form-input" rows="20" readonly></textarea>
              <div class="mt-4 p-4 bg-gray-50 rounded-lg">
                <h5 class="mb-2">Generation Stats</h5>
                <div class="grid grid-cols-2 gap-4 text-sm">
                  <div>
                    <span class="font-medium">Word Count:</span>
                    <span id="output-word-count">0</span>
                  </div>
                  <div>
                    <span class="font-medium">Credits Used:</span>
                    <span id="credits-used">0</span>
                  </div>
                  <div>
                    <span class="font-medium">Generation Time:</span>
                    <span id="generation-time">0s</span>
                  </div>
                  <div>
                    <span class="font-medium">Quality Tier:</span>
                    <span id="used-quality-tier">Standard</span>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- File Upload Modal -->
  <div id="upload-modal" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h3>Upload Files</h3>
        <button id="close-upload-modal" class="btn-close">&times;</button>
      </div>
      <div class="modal-body">
        <div class="upload-area" id="upload-area">
          <i class="fas fa-cloud-upload-alt text-4xl text-gray mb-4"></i>
          <p class="mb-2">Drag and drop files here or click to browse</p>
          <p class="text-sm text-gray mb-4">Supported: PDF, DOCX, TXT (Max 5 files, 10MB each)</p>
          <input type="file" id="file-input" multiple accept=".pdf,.docx,.txt" style="display: none;">
          <button class="btn btn-outline" onclick="document.getElementById('file-input').click()">
            Choose Files
          </button>
        </div>
        <div id="file-list" class="mt-4" style="display: none;"></div>
        <div class="mt-4">
          <button class="btn btn-primary w-full" id="process-files-btn" disabled>
            <i class="fas fa-cogs"></i> Process Files & Generate
          </button>
        </div>
      </div>
    </div>
  </div>
  
  <!-- User Profile Modal -->
  <div id="user-profile-modal" class="modal" style="display: none;">
    <div class="modal-content">
      <div class="modal-header">
        <h3>User Profile</h3>
        <button id="close-profile-modal" class="btn-close">&times;</button>
      </div>
      <div class="modal-body">
        <div class="profile-section">
          <div class="profile-avatar">
            <i class="fas fa-user-circle text-6xl text-primary"></i>
          </div>
          <div class="profile-info">
            <h4 id="modal-user-name">User Name</h4>
            <p class="text-gray" id="modal-user-email">john.doe@example.com</p>
            <div class="plan-info">
              <span class="plan-badge" id="modal-user-plan">Free Plan</span>
              <div class="credits-info">
                <i class="fas fa-coins text-orange"></i>
                <span id="modal-user-credits">145/200 Credits</span>
              </div>
            </div>
          </div>
        </div>
        <div class="profile-actions">
          <button class="btn btn-outline" onclick="window.location.href='auth.html'">Account Settings</button>
          <button class="btn btn-primary" onclick="window.location.href='pricing.html'">Upgrade Plan</button>
          <button class="btn btn-outline" onclick="logout()">Logout</button>
        </div>
      </div>
    </div>
  </div>

  <script src="./js/userSession.js"></script>
  <script>
    // Global variables
    let selectedFiles = [];
    let currentContentType = 'general';
    let isGenerating = false;

    // API helper functions
    function getAuthToken() {
      return localStorage.getItem('authToken') || 'mock-token';
    }

    async function makeAuthenticatedRequest(url, options = {}) {
      const token = getAuthToken();
      return fetch(url, {
        ...options,
        headers: {
          'Content-Type': 'application/json',
          'Authorization': `Bearer ${token}`,
          ...options.headers
        }
      });
    }

    // Initialize page
    document.addEventListener('DOMContentLoaded', function() {
      // Check authentication
      if (!window.userSession.requireAuthentication()) {
        return;
      }
      
      initializeEventListeners();
      updateWordCount();
    });

    function initializeEventListeners() {
      // Content type selection
      document.querySelectorAll('[data-type]').forEach(btn => {
        btn.addEventListener('click', function() {
          document.querySelectorAll('[data-type]').forEach(b => b.classList.remove('active'));
          this.classList.add('active');
          currentContentType = this.dataset.type;
          toggleAssignmentFields();
        });
      });

      // Word count tracking
      document.getElementById('content-prompt').addEventListener('input', updateWordCount);

      // Generate button
      document.getElementById('generate-btn').addEventListener('click', generateContent);

      // File upload functionality
      document.getElementById('upload-files-btn').addEventListener('click', () => {
        document.getElementById('upload-modal').style.display = 'flex';
      });

      document.getElementById('close-upload-modal').addEventListener('click', () => {
        document.getElementById('upload-modal').style.display = 'none';
      });

      // File input handling
      const fileInput = document.getElementById('file-input');
      fileInput.addEventListener('change', handleFileSelection);

      // Drag and drop
      const uploadArea = document.getElementById('upload-area');
      uploadArea.addEventListener('dragover', handleDragOver);
      uploadArea.addEventListener('drop', handleFileDrop);

      // Process files button
      document.getElementById('process-files-btn').addEventListener('click', processFilesAndGenerate);

      // Output actions
      document.getElementById('copy-btn').addEventListener('click', copyToClipboard);
      document.getElementById('download-btn').addEventListener('click', downloadContent);
      document.getElementById('save-btn').addEventListener('click', saveToHistory);

      // Sidebar functionality
      initializeSidebar();
    }

    function toggleAssignmentFields() {
      const assignmentFields = document.getElementById('assignment-title-group');
      const citationOptions = document.getElementById('citation-options');
      
      if (currentContentType === 'assignment') {
        assignmentFields.style.display = 'block';
        citationOptions.style.display = 'block';
      } else {
        assignmentFields.style.display = 'none';
        citationOptions.style.display = 'none';
      }
    }

    function updateWordCount() {
      const prompt = document.getElementById('content-prompt').value;
      const wordCount = prompt.trim() ? prompt.trim().split(/\s+/).length : 0;
      document.querySelector('.text-right').textContent = `${wordCount} words`;
    }

    async function generateContent() {
      if (isGenerating) return;

      const prompt = document.getElementById('content-prompt').value.trim();
      const wordCount = parseInt(document.getElementById('word-count').value);
      const style = document.getElementById('writing-style').value;
      const tone = document.getElementById('writing-tone').value;
      const qualityTier = document.getElementById('quality-tier').value;
      const additionalInstructions = document.getElementById('additional-instructions').value.trim();

      if (!prompt) {
        alert('Please enter a content prompt');
        return;
      }

      if (wordCount < 100 || wordCount > 2000) {
        alert('Word count must be between 100 and 2000');
        return;
      }

      try {
        isGenerating = true;
        showLoading('Generating your content...');

        const requestData = {
          prompt,
          style,
          tone,
          wordCount,
          qualityTier,
          additionalInstructions
        };

        // Add assignment-specific fields
        if (currentContentType === 'assignment') {
          const assignmentTitle = document.getElementById('assignment-title').value.trim();
          if (!assignmentTitle) {
            alert('Please enter an assignment title');
            return;
          }
          
          requestData.contentType = 'assignment';
          requestData.assignmentTitle = assignmentTitle;
          requestData.citationStyle = document.getElementById('citation-style').value;
          requestData.requiresCitations = document.getElementById('require-citations').checked;
        }

        const response = await makeAuthenticatedRequest('/api/writer/generate', {
          method: 'POST',
          body: JSON.stringify(requestData)
        });

        const result = await response.json();

        if (!response.ok) {
          throw new Error(result.error || 'Generation failed');
        }

        if (result.success) {
          displayGeneratedContent(result);
          updateUserCredits(result.metadata.creditsUsed, result.metadata.newBalance);
        } else {
          throw new Error(result.error || 'Generation failed');
        }

      } catch (error) {
        console.error('Generation error:', error);
        showError(error.message);
      } finally {
        isGenerating = false;
        hideLoading();
      }
    }

    function displayGeneratedContent(result) {
      document.getElementById('no-content').style.display = 'none';
      document.getElementById('content-output').style.display = 'block';
      document.getElementById('output-actions').style.display = 'flex';

      document.getElementById('generated-content').value = result.content;
      document.getElementById('output-word-count').textContent = result.metadata.wordCount || 0;
      document.getElementById('credits-used').textContent = result.metadata.creditsUsed || 0;
      document.getElementById('generation-time').textContent = `${(result.metadata.generationTime / 1000).toFixed(1)}s`;
      document.getElementById('used-quality-tier').textContent = result.metadata.qualityTier === 'premium' ? 'Premium' : 'Standard';
    }

    function showLoading(message) {
      document.getElementById('no-content').style.display = 'none';
      document.getElementById('content-output').style.display = 'none';
      document.getElementById('loading-content').style.display = 'block';
      document.getElementById('loading-message').textContent = message;
      document.getElementById('generate-btn').disabled = true;
      document.getElementById('generate-btn').innerHTML = '<i class="fas fa-spinner fa-spin"></i> Generating...';
    }

    function hideLoading() {
      document.getElementById('loading-content').style.display = 'none';
      document.getElementById('generate-btn').disabled = false;
      document.getElementById('generate-btn').innerHTML = '<i class="fas fa-magic"></i> Generate Content';
    }

    function showError(message) {
      document.getElementById('loading-content').style.display = 'none';
      document.getElementById('no-content').style.display = 'block';
      alert(`Error: ${message}`);
    }

    // File handling functions
    function handleFileSelection(event) {
      const files = Array.from(event.target.files);
      selectedFiles = files;
      displaySelectedFiles();
    }

    function handleDragOver(event) {
      event.preventDefault();
      event.currentTarget.classList.add('drag-over');
    }

    function handleFileDrop(event) {
      event.preventDefault();
      event.currentTarget.classList.remove('drag-over');
      const files = Array.from(event.dataTransfer.files);
      selectedFiles = files;
      document.getElementById('file-input').files = event.dataTransfer.files;
      displaySelectedFiles();
    }

    function displaySelectedFiles() {
      const fileList = document.getElementById('file-list');
      const processBtn = document.getElementById('process-files-btn');
      
      if (selectedFiles.length === 0) {
        fileList.style.display = 'none';
        processBtn.disabled = true;
        return;
      }

      fileList.style.display = 'block';
      fileList.innerHTML = '<h5>Selected Files:</h5>';
      
      selectedFiles.forEach((file, index) => {
        const fileItem = document.createElement('div');
        fileItem.className = 'file-item';
        fileItem.innerHTML = `
          <div class="flex justify-between items-center p-2 border rounded">
            <div>
              <span class="font-medium">${file.name}</span>
              <span class="text-sm text-gray">(${(file.size / 1024 / 1024).toFixed(2)} MB)</span>
            </div>
            <button class="btn btn-sm btn-outline" onclick="removeFile(${index})">
              <i class="fas fa-times"></i>
            </button>
          </div>
        `;
        fileList.appendChild(fileItem);
      });

      processBtn.disabled = false;
    }

    function removeFile(index) {
      selectedFiles.splice(index, 1);
      displaySelectedFiles();
    }

    async function processFilesAndGenerate() {
      if (selectedFiles.length === 0) {
        alert('Please select files to process');
        return;
      }

      try {
        showLoading('Processing files and generating content...');

        const formData = new FormData();
        selectedFiles.forEach(file => {
          formData.append('files', file);
        });

        // Add generation parameters
        formData.append('additionalPrompt', document.getElementById('content-prompt').value.trim());
        formData.append('style', document.getElementById('writing-style').value);
        formData.append('tone', document.getElementById('writing-tone').value);
        formData.append('wordCount', document.getElementById('word-count').value);
        formData.append('qualityTier', document.getElementById('quality-tier').value);

        const response = await fetch('/api/writer/upload-and-generate', {
          method: 'POST',
          headers: {
            'Authorization': `Bearer ${getAuthToken()}`
          },
          body: formData
        });

        const result = await response.json();

        if (!response.ok) {
          throw new Error(result.error || 'File processing failed');
        }

        if (result.success) {
          displayGeneratedContent(result);
          updateUserCredits(result.metadata.creditsUsed, result.metadata.newBalance);
          document.getElementById('upload-modal').style.display = 'none';
        } else {
          throw new Error(result.error || 'File processing failed');
        }

      } catch (error) {
        console.error('File processing error:', error);
        showError(error.message);
      } finally {
        hideLoading();
      }
    }

    // Output action functions
    function copyToClipboard() {
      const content = document.getElementById('generated-content').value;
      navigator.clipboard.writeText(content).then(() => {
        showNotification('Content copied to clipboard!');
      }).catch(err => {
        console.error('Copy failed:', err);
        alert('Failed to copy content');
      });
    }

    function downloadContent() {
      const content = document.getElementById('generated-content').value;
      const blob = new Blob([content], { type: 'text/plain' });
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url;
      a.download = `generated-content-${Date.now()}.txt`;
      document.body.appendChild(a);
      a.click();
      document.body.removeChild(a);
      URL.revokeObjectURL(url);
    }

    async function saveToHistory() {
      try {
        const content = document.getElementById('generated-content').value;
        const response = await makeAuthenticatedRequest('/api/assignments/save-to-history', {
          method: 'POST',
          body: JSON.stringify({
            content,
            title: currentContentType === 'assignment' ? 
              document.getElementById('assignment-title').value : 
              'Generated Content',
            metadata: {
              style: document.getElementById('writing-style').value,
              tone: document.getElementById('writing-tone').value,
              wordCount: document.getElementById('word-count').value,
              contentType: currentContentType
            }
          })
        });

        const result = await response.json();

        if (result.success) {
          showNotification('Content saved to history!');
        } else {
          throw new Error(result.error || 'Save failed');
        }

      } catch (error) {
        console.error('Save error:', error);
        alert('Failed to save content to history');
      }
    }

    function updateUserCredits(creditsUsed, newBalance) {
      if (window.userSession) {
        // Use server-provided balance if available, otherwise calculate locally
        const finalBalance = newBalance !== undefined ? newBalance : (() => {
          const currentUser = window.userSession.getCurrentUser();
          return Math.max(0, currentUser.credits - (creditsUsed || 0));
        })();
        
        window.userSession.updateUser({ credits: newBalance });
        console.log(`Credits updated: Used ${creditsUsed}, New balance: ${finalBalance}`);
      }
    }

    function showNotification(message) {
      // Simple notification - could be enhanced with a proper notification system
      const notification = document.createElement('div');
      notification.className = 'notification';
      notification.textContent = message;
      notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: #10b981;
        color: white;
        padding: 12px 20px;
        border-radius: 8px;
        z-index: 1000;
        animation: slideIn 0.3s ease;
      `;
      document.body.appendChild(notification);
      
      setTimeout(() => {
        notification.remove();
      }, 3000);
    }

    function initializeSidebar() {
      const sidebarToggle = document.getElementById('sidebar-toggle');
      const sidebar = document.getElementById('dashboard-sidebar');
      const dashboardLayout = document.querySelector('.dashboard-layout');
      
      sidebarToggle.addEventListener('click', function() {
        if (window.innerWidth <= 768) {
          sidebar.classList.toggle('sidebar-open');
          dashboardLayout.classList.toggle('sidebar-active');
        } else {
          dashboardLayout.classList.toggle('sidebar-collapsed');
        }
      });
      
      document.addEventListener('click', function(event) {
        if (window.innerWidth <= 768) {
          if (!sidebar.contains(event.target) && !sidebarToggle.contains(event.target) && sidebar.classList.contains('sidebar-open')) {
            sidebar.classList.remove('sidebar-open');
            dashboardLayout.classList.remove('sidebar-active');
          }
        }
      });
      
      window.addEventListener('resize', function() {
        if (window.innerWidth > 768) {
          sidebar.classList.remove('sidebar-open');
          dashboardLayout.classList.remove('sidebar-active');
        } else {
          dashboardLayout.classList.remove('sidebar-collapsed');
        }
      });

      // User profile modal
      document.getElementById('user-profile-card').addEventListener('click', function() {
        document.getElementById('user-profile-modal').style.display = 'flex';
      });
      
      document.getElementById('close-profile-modal').addEventListener('click', function() {
        document.getElementById('user-profile-modal').style.display = 'none';
      });
      
      document.getElementById('user-profile-modal').addEventListener('click', function(e) {
        if (e.target === this) {
          this.style.display = 'none';
        }
      });
    }

    // CSS for animations and styling
    const style = document.createElement('style');
    style.textContent = `
      .spinner {
        width: 40px;
        height: 40px;
        border: 4px solid #f3f4f6;
        border-top: 4px solid #3b82f6;
        border-radius: 50%;
        animation: spin 1s linear infinite;
        margin: 0 auto;
      }
      
      @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
      }
      
      @keyframes slideIn {
        from { transform: translateX(100%); opacity: 0; }
        to { transform: translateX(0); opacity: 1; }
      }
      
      .drag-over {
        border-color: #3b82f6 !important;
        background-color: #eff6ff !important;
      }
      
      .upload-area {
        border: 2px dashed #d1d5db;
        border-radius: 12px;
        padding: 2rem;
        text-align: center;
        transition: all 0.3s ease;
        cursor: pointer;
      }
      
      .upload-area:hover {
        border-color: #3b82f6;
        background-color: #f8fafc;
      }
      
      .file-item {
        margin-bottom: 0.5rem;
      }
    `;
    document.head.appendChild(style);
  </script>
</body>
</html>